## 粗看ERD和ERS

ERD和ERS是信号随机叠加的两种不同的现象，
它们的差异更多地是体现在叠加的波形上，
而在它们的幅度上，不容易看到较大的差异。

---

- [粗看ERD和ERS](#粗看erd和ers)
- [何为ERD和ERS](#何为erd和ers)
- [信号模拟](#信号模拟)
- [直观分析](#直观分析)

## 何为ERD和ERS

ER的全称是`Event-Related`，
S和D分别是同步（`Synchronization`）和去同步（`De-synchronization`）。

简单来说，它是说当一个“事件”发生后，
系统对这个事件产生响应（`ER`）。
而响应比较复杂，
可以分解为若干个信号

$$y_i = cos(\omega_i \cdot t + \phi)$$

外界观测到的是叠加信号

$$y = \sum_i y_i$$

而信号的复杂性体现在两点，
首先，同样频率的信号不是一个，而是若干个；
其次，若干个信号的相位具有时变特性；

$$y_{i, j} = cos(\omega_i \cdot t + \phi_{i, j} (\omega_i, t))$$

$$y = \sum_{i, j} y_{i, j}$$

在同步条件（`S`）下，
同一个频率下的各个相位函数相同

$$\phi_{i, j} = \phi_{i, k}$$

在去同步条件（`D`）下，
各个相位函数不同

$$\phi_{i, j} \neq \phi_{i, k}$$

然而，现实不会有这样非黑即白的情况，
因此，大多数情况下的相位函数不会完全相等，
而是具有一定的连续性，
那么同步和去同步状态就是相对非不是绝对的。

更为复杂的是，
同步和去同步差异在不同的时间范围内，
也是不同的

$$\phi_{i, j}(t) = \phi_{i, k}(t), t \in (t_0, t_1)$$
$$\phi_{i, j}(t) \neq \phi_{i, k}(t), t \in (t_1, t_2)$$

因此，不容易对它进行理论计算分析。

## 信号模拟

为了刻画这种相位的时变特性，
我按照以上的规律，
生成了一组信号。
信号参数如下

- 采样频率：1000 赫兹；
- 信号长度：1秒；
- 频率范围：1 - 50 赫兹；
- 各个频率中的信号数量（相位生成函数的数量）：100个。

其中，我通过控制相位生成函数的随机差异（方差大小），
对信号的局部同步和去同步特性进行量化。

## 直观分析

一个典型的例子如下

![erd-ers-1](./erd-ers-1.png)

其中，上半部分是全时间-频率范围内的`ERS`水平，
数值越大，则代表信号的相位越相似（同步性越强）；
数值越小，则代表信号的相位越不相似（同步性越弱）。

多次模拟的结果表明，
`ERD`和`ERS`的差异很少直接表现在信号幅度上，
但可以通过大致的模式进行“捕风捉影”式的检测，
同步区出现的区域频率越低，则这种现象越明显。

相似的结果还有

![erd-ers-2](./erd-ers-2.png)

上图所示，在时频图中较大面积的`ERS`会诱发较为“集中”的时域信号。