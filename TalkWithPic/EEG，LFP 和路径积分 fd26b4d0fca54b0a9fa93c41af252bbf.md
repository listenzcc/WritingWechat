# EEG，LFP 和路径积分

上篇文章中，我成功模拟了有限源数量下的头皮 EEG 处的电场强度。但如果您做过 EEG 实验的话，可能会觉得我是在胡扯，因为采集到的 EEG 信号是标量而非矢量。因此您心中会有疑惑：那些黑色矢量是干什么用的？

本文将回答这个问题，在本文的代码中，**黑色矢量是局部电场梯度，而我使用路径积分的方式将电场梯度转化为 EEG 设备采集到的电压值。**

本文代码开源，可见我的 ObservableHQ 笔记本

[LFP & EEG and Path Integral](https://observablehq.com/@listenzcc/lfp-eeg-and-path-integral)

---
- [EEG，LFP 和路径积分](#eeglfp-和路径积分)
  - [从电场梯度到电压值](#从电场梯度到电压值)
  - [EEG 中的零参考与路径积分](#eeg-中的零参考与路径积分)
  - [附录：保守场的闭曲线路径积分为零](#附录保守场的闭曲线路径积分为零)


## 从电场梯度到电压值

上篇文章中，我成功模拟了有限源数量下的头皮 EEG 处的电场强度。但如果您做过 EEG 实验的话，可能会觉得我是在胡扯，因为采集到的 EEG 信号是标量而非矢量。因此，您心中会有疑惑：那些黑色矢量是干什么用的？

本文将回答这个问题，在本文的代码中，**黑色矢量是局部电场梯度，而我使用路径积分的方式将电场梯度转化为 EEG 设备采集到的电压值。**

## EEG 中的零参考与路径积分

既然我们开始涉及到 EEG 的数据采集场景，那么我假设读者进行过基本的电压测量的操作。采集电压数据的第一步是选择参考电位，这个电位称为“零点”或“参考电位”，这个电位其实是路径积分的起点。

那么，**何为路径积分？它与电压值有什么关系呢？**

电压和路径积分之间存在紧密的关系，它们之间的关系可以通过路径积分的定义来解释。路径积分是一个沿着路径对矢量场进行积分的过程。**对于电场而言，电压可以看作是沿着电场的路径积分。**

由于有“保守场的闭曲线路径积分为零”这个结论，因此保守场路径积分值与路径选择无关。这保证了我只要沿着下图中的圆圈对电场梯度进行曲线积分，即可得到各个点的电压值。下图中的黑色大圆圈就是本例中选择的参考零电位点。

![Untitled](EEG%EF%BC%8CLFP%20%E5%92%8C%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%20fd26b4d0fca54b0a9fa93c41af252bbf/Untitled.png)

设有一个电场 $\mathbf{E}$，其电压可以表示为沿着路径 $C$ 的积分：

$$
V = \int_C \mathbf{E} \cdot d\mathbf{r}
$$

其中，$\mathbf{E}$ 是电场矢量，$d\mathbf{r}$ 是路径上的微元矢量。

路径积分的结果是一个标量，表示在路径上电场沿着路径的方向和强度的累积效应。通过对路径上的微元矢量和电场矢量进行点积，我们可以得到每个微元路径上的电场沿该路径的贡献，并将其累加起来，从而得到整个路径上的电压。

因此，路径积分提供了计算电压的方法，它描述了电场沿着路径的积累效应。路径积分的结果是电压值，表示在给定路径上的电场累积效应。

## 附录：保守场的闭曲线路径积分为零

为了证明保守场的闭曲线路径积分为零，我们可以利用斯托克斯定理。斯托克斯定理描述了一个矢量场沿着一个闭合曲线的环路积分与该矢量场在该闭合曲线所围成的曲面上的环面积分之间的关系。

设有一个保守场 $\mathbf{F}$，满足 $\mathbf{F} = \nabla \phi$，其中 $\phi$ 是一个标量场，$\nabla$ 表示梯度算子。现在考虑一个闭合曲线 $C$，以逆时针方向围成一个面 $S$。

根据斯托克斯定理，闭曲线的环路积分可以表示为：

$$
\oint_C \mathbf{F} \cdot d\mathbf{r} = \iint_S (\nabla \times \mathbf{F}) \cdot d\mathbf{S}
$$

其中，$\mathbf{r}$ 是路径上的位置矢量，$d\mathbf{r}$ 是路径上的微元矢量，$\mathbf{S}$ 是曲面 $S$ 的法向量，$d\mathbf{S}$ 是曲面元素。

由于 $\mathbf{F}$ 是保守场，我们可以将其写为 $\mathbf{F} = \nabla \phi$，然后将其代入上述公式中，得到：

$$
\oint_C (\nabla \phi) \cdot d\mathbf{r} = \iint_S (\nabla \times (\nabla \phi)) \cdot d\mathbf{S}
$$

由矢量恒等式 $\nabla \times (\nabla \phi) = \mathbf{0}$，我们得到：

$$
\oint_C (\nabla \phi) \cdot d\mathbf{r} = \iint_S \mathbf{0} \cdot d\mathbf{S} = 0
$$

因此，保守场的闭曲线路径积分为零。