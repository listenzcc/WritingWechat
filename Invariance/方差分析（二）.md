## 方差分析（二）

上文描述了二阶统计量的稳定性，
本文将基于二阶统计量的计算方式，
对它的变动来源进行分析。

---

- [方差分析（二）](#方差分析二)
- [随机变量的二次方程](#随机变量的二次方程)
- [假设与检验](#假设与检验)

## 随机变量的二次方程

对于任意随机变量$X$，
无论它服从什么分布，
我们都可以对它进行采样

$$\{x_i | x_i \in X\}$$

它的样本均值为

$$\bar{X} = \frac{1}{n} \sum_{i=0}^n x_i$$

易见，样本均值是总体均值的无偏估计

$$E(\bar{X}) = \frac{1}{n} \sum_{i=0}^n E(X) = E(X)$$

而它的二阶原点矩$X^2$，
和二阶中心矩$(X - E(X))^2$
具有如下对应关系

$$E(X - E(X))^2 = E(X^2) - E^2(X) $$

易见，左式代表随机变量的方差$D(X)$。

之后对随机变量进行分解$X=X_1 + X_2$

$$D(X) = E(X_1 + X_2)^2 - E^2(X_1 + X_2)$$

展开后可得

$$D(X) = D(X_1) + D(X_2) + (E(X_1 X_2) - E(X_1)E(X_2))$$

上式说明在$X_1, X_2$相互独立的条件下，
随机变量的方差具有可加性；
而在存在相关关系的情况下，
随机变量和的方差大于方差之和，
差值为变量之间的协方差。

这是一个相当基础的结论，
下面我们对变量分解的过程进行如下规定，

-   将所有样本“任意”分为两类；
-   规定随机变量$X_1$的值为该类样本的样本均值；
-   规定随机变量$X_2 = X - X_1$为该样本值与该类均值的差；
-   这样方差的三项就具有了意义

$$D(X) = Var_{Across} + Var_{Within} + Var_{Inter}$$

其中，$Across$代表类间差异，$Within$代表类内差异，$Inter$代表类间的协变关系。

更加神奇的是，这种对应关系并不拘泥于`2`类的情况

$$D(X) \\= E(\sum_i X_i)^2 + E^2(\sum_i X_i) \\= \sum_i D(X_i) + \sum_{i, j} Cov(X_i, X_j)$$

上式说明，方差的可加关系可以“轻易”地扩展到多个条件联合作用的情形，
并且，只要保证多个条件之间是“正交的”，就可以不去理会它们之间的相互作用，
因为它们的“协方差”必为零。

## 假设与检验

不难发现，方差的可加性简直就是为线性模型“量身定制”的良好性质

$$X = \sum_i \beta_i X_i + \epsilon$$

对于这样的模型，它的零假设是

> 假设$X_i$服从标准正态分布，且$\beta_i$的值相同。

在零假设成立的情况下，
我们可以对样本进行任意“分类”，
并按照上式对样本方差、类间差异、类内差异进行直接计算，
（**注意，这里无法计算协变关系，因为计算过于复杂且并无必要**）。

利用方差的可加性，
可以构造新的统计量

$$F_{Across} = \frac{Var_{Across}}{Var_{Within}}$$

以及

$$F_{Inter} = \frac{Var_{Inter}}{Var_{Within}}$$

等进行计算，
并易知它们应当服从$F(a, b)$分布，
其中$a, b$分别代表分子和分母的自由度。

这里注意到，

$$Var_{Within}$$

这个变量只能被减小，但难以被清零，
也就是说，无论样本的类别如何分配，
它都不可能小于系统误差$\epsilon$项表示的总体方差。

另外，由$F$分布的形式可得，
它具有单边分布的形式

$$p(t) \sim F(t) \in (0, +\infty)$$

其期望为

$$\int_0^\infty t p(t) dt = \frac{a}{b}$$

当实际取值远离这个期望时，
说明小概率事件出现，
小概率事件出现，
就意味着原本的假设不再成立。

由于二次型的形式比较复杂，
下一篇将对它们进行详细介绍。