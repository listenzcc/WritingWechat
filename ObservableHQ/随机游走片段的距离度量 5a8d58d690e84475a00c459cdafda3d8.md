# 随机游走片段的距离度量

本文尝试对随机游走过程得到的随机时间序列进行度量分析，通过分析这些时间序列之间的欧氏距离建立度量空间，并对该空间进行呈现。本文的开源代码可见我的 ObservableHQ 笔记本

[Distance between the brownian bridges](https://observablehq.com/@listenzcc/distance-between-the-brownian-bridges)

---
- [随机游走片段的距离度量](#随机游走片段的距离度量)
  - [经过桥运算的时间序列图](#经过桥运算的时间序列图)
  - [时间片段之间的距离分布图](#时间片段之间的距离分布图)
  - [核函数及其在 PCA 空间中的样本映射图](#核函数及其在-pca-空间中的样本映射图)


## 经过桥运算的时间序列图

在随机游走的动力学过程中，其位置与起始点的距离随时间不断增大，因此对原始时间序列进行分析是有困难的。而前文所介绍的布朗桥运算可以模拟生成一组“不断回归到原点”的随机游走时间序列片段，如下图所示。这些片段具有相似的信号分布，因此可以对这些片段之间的“差异”进行度量和比较。

![Untitled](%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E7%89%87%E6%AE%B5%E7%9A%84%E8%B7%9D%E7%A6%BB%E5%BA%A6%E9%87%8F%205a8d58d690e84475a00c459cdafda3d8/Untitled.png)

## 时间片段之间的距离分布图

接下来，我们通过欧氏距离对各个片段距离进行度量，计算方法如下

$$
\begin{cases}
\mathcal{L} = \frac{1}{n}\Vert B_i - B_j \Vert _2^2 \\
A-B = \sum_{i=1}^n (A_i - B_i) \\
i, j \in [1, 2, \dots, k]
\end{cases}
$$

其中，$A_i, B_j, n, k$ 分别代表两个信号片段、这些片段的时间点数以及片段数量。时间片段之间的距离分布如下图所示，左侧为片段之间的距离矩阵，$R^{k \times k}$，右侧为距离的直方图。

![Untitled](%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E7%89%87%E6%AE%B5%E7%9A%84%E8%B7%9D%E7%A6%BB%E5%BA%A6%E9%87%8F%205a8d58d690e84475a00c459cdafda3d8/Untitled%201.png)

![Untitled](%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E7%89%87%E6%AE%B5%E7%9A%84%E8%B7%9D%E7%A6%BB%E5%BA%A6%E9%87%8F%205a8d58d690e84475a00c459cdafda3d8/Untitled%202.png)

## 核函数及其在 PCA 空间中的样本映射图

接下来，我们主要关注距离矩阵，不再将它看作是矩阵，而是向量的集合。而每一个向量 $R^k$，都是“用其他片段的距离描述某个片段”的向量。因此我们可以不再关心时间序列的细节，而只通过片段之间的距离关系来对描述该向量。这就是核函数的思想。

在核函数的视角下，我们可以对距离矩阵进行 PCA 分解，由于距离矩阵的对称性，我们可以假定它具有实特征值，因此假定 PCA 分解存在，进而对每个信号片段求得它在 PCA 空间中的低维表示。我们选取它的前两个主成分，进行绘制如下图所示。通过多次模拟可知，样本的分布总是呈现“月牙”的形状，而月牙中各个局部的密度也是不同的。

![Untitled](%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E7%89%87%E6%AE%B5%E7%9A%84%E8%B7%9D%E7%A6%BB%E5%BA%A6%E9%87%8F%205a8d58d690e84475a00c459cdafda3d8/Untitled%203.png)

![Untitled](%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E7%89%87%E6%AE%B5%E7%9A%84%E8%B7%9D%E7%A6%BB%E5%BA%A6%E9%87%8F%205a8d58d690e84475a00c459cdafda3d8/Untitled%204.png)