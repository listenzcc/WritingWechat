## 色块拼图

计算机里的图像一般是方方正正的，
由像素组成的矩形集合。

而人描述一个场景或图像时，
所使用的往往不是这样规矩的矩形，
而是这样的话语

> 这里有山有云，在夕阳下，
> 山和云都显出很好看的红色。

因此，我们或许可以尝试使用“色块”对场景进行描述。

【这是一段棒到不行的视频】

本样例的代码可见我的[在线笔记本](https://observablehq.com/@listenzcc/quadtree-art "在线笔记本")。

---

- [色块拼图](#色块拼图)
- [像素矩形](#像素矩形)
- [色块矩形](#色块矩形)
  - [算法实现](#算法实现)
- [潜在应用](#潜在应用)
  - [实用性考虑](#实用性考虑)
  - [研究性考虑](#研究性考虑)

## 像素矩形

计算机里的图像一般是方方正正的，
由像素组成的矩形集合。

一张典型的图像有横、纵两个方向，
在两个方向上，分别包含一些像素，
如`1920 x 1080`、`800 x 600`等，
就代表在横向上有`1920`，在纵向上有`1080`个像素。

![Rect Pic 2](./rect-pic-2.jpg)

这样的表达方式有无数的好处，
但其中的一个问题是，
它与人类视觉的图像表达是相悖的。

让我们暂时抛开这张图像，
一个人会如何描述这个场景呢？

> 有是一座山沉浸在夕阳里。
> 今天的夕阳呈现一种粉色的光辉，
> 在山上映出橙红的和暗灰的光影。
> 今天的天也不是很高，飘着大片的云，
> 也映出橙红的和暗灰的光影。

人会记住这些，
而不是每个像素的`RGB`。
所以我们也许可以使用较大的“色块”，
而不是微小的“像素”来描述这个场景。

## 色块矩形

先抛出一个极其实用的效果，
我们不再关心每个像素细节上的值，
而是用“相当大”的色块来渲染

![Rect Pic 1](./rect-pic-1.png)

这是一张整体的图，
在细节上，它是这样的

![Rect Pic 3](./rect-pic-3.png)

可以看到，
在这种渲染方式下，
图像在细节不那么重要的地方，
使用较大的色块来表示；
在细节丰富的地方，
转而使用精细的色块进行细化描述。

### 算法实现

这种场景的渲染可以通过迭代的方式进行实现，

- 对图像进行划分，使用笛卡尔坐标系，分为`4`个象限；
- 分别对`4`个象限，各使用一个色块对它进行描述；
- 根据这种描述的“误差”进行排序，误差最大的色块进入下一个循环；
- 回到图像划分，进行迭代。

本样例的代码实现使用
[开源代码](https://github.com/mourner/tinyqueue "开源代码")。

## 潜在应用

### 实用性考虑

如开头的视频所示，
色块渲染的精细程度是可控的。
它的迭代终点是还原成“像素级”的图像渲染形式。

这种可控性可以用于在网络环境较差时，
对图像的在线传输和呈现进行动态控制。

具体来说，在用户尝试获取图像并呈现时，
先传输较大的色块；
之后，在网络允许的情况下，
逐步传输细节色块，
直到达到设计要求。

### 研究性考虑

目前的图像识别，
都是使用“像素级”的图像进行计算，
而由于图像内容可能具有“色块大小”的可区分性内容，
使用像素进行计算可能并不是最优的方式。

或许，我们可以找到一种方法，
以“色块”为单位，
代替“像素”进行计算。
这样做有望提高计算效率，
并更加充分地利用图像的“内容”。