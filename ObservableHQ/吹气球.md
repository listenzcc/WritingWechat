## 吹气球

`FreeSurfer`是将功能磁成像数据映射到大脑皮层空间的软件。
它的计算原理就像吹气球。

---

-   [吹气球](#吹气球)
-   [大脑皮层](#大脑皮层)
    -   [皮层可视化](#皮层可视化)

## 大脑皮层

人类大脑的主要认知加工是由大脑皮层完成，
皮层，顾名思义就是一层皮脂。
正常状态下，它是蜷曲地安放在颅骨之内。

![surface normal raw](./surface-normal-raw.png)

其中的颜色代表局部皮层微元的朝向。

为了研究脑皮层的区域和功能，
需要将它展开成**凸闭曲面**的形式，

> 凸闭曲面是这样一种曲面，
> 在其内部任意两点之间的连线所经过的所有点，
> 都在曲面所围空间的内部。

简单来说，就是把脑皮层像“吹气球”一样吹起来。
这个过程可以用如下动画所示

【这是一段棒到不行的视频】

当然这个曲面展开的计算是由`FreeSurfer`软件所完成的。
在此，我将借用它的计算结果进行一些简单的可视化说明。

### 皮层可视化

首先，将皮层微元按其面积进行着色

![surface raw](./surface-raw.png)

可以看到，皮层在蜷曲状态下拥有沟、回两种基本结构，
它们具有较为明显的形态学特征，

-   回是外凸的、而沟是内凹的，这是废话，但下面两点很意思；
-   回的微元面积较大，说明该处曲率较小；
-   沟的微元面积较小，说明该处曲率较大。

综合以上结果，
说明皮层的外凸和内凹两种形态并不是一致的。

不同之处在于，皮层越往内凹，就蜷曲地越严重。
这暗示着皮层发育过程是由于遇到颅骨的阻碍，
而被迫产生向的蜷曲。
一个支持这个假说的解释是由于脑容量的限制，
导致皮层越发育，向内的蜷曲就越多，
从而使单位面积内，拥挤的皮层面积就越大，
最终呈现出曲率越来越大的形态学现象。

之后，将皮层在被“吹气球”后的面积变化进行可视化

![surface ratio](./surface-ratio.png)

其中，颜色越亮代表在“吹气球”过程中，
该处的尺寸放大就越严重。

可以看到，较亮的区域集中在重要的沟位置，
如中央沟、顶内沟等。
该结果似乎支持了上述假说。
我们可以考虑一个反向的逻辑，
如果某个区域在鼓胀的过程中变得越来越大，
则说明它原本就是被压缩得越来越小。

最后，我还比较好奇的是`FreeSurfer`是如何达到吹气球的效果。

![surface sphere](./surface-sphere.png)

该图按照展开成球形后的皮层微元大小，
对皮层进行了染色。

可以看到，这些优秀的程序员们偷了个大懒，
他们只是单纯地建立了一个类似足球的球模型，
这个足球是固定的，
皮层上的微元只是按照它们的欧拉角映射到足球特定位置上，
然后按需拉伸到相应的程序而已。
相当高明。

本工程代码可见[我的代码仓库](https://observablehq.com/@listenzcc/free-surfer-cortex "我的代码仓库")。

从`FreeSurfer`模型中[提取三维数据的代码](https://github.com/listenzcc/extractFreeSurfer "提取三维数据的代码")可见我的`GITHUB`页面。
