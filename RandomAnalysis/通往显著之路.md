## 通往显著之路

上文《从检验到瞎编》介绍了统计检验的基本方法。
并引出了多重比较校正的概念和经典的FWE校正方法，本文将介绍另一种多重比较校正方法。

---

- [通往显著之路](#通往显著之路)
  - [过于严格的FWE方法](#过于严格的fwe方法)
  - [寻找出路](#寻找出路)
  - [FDR校验](#fdr校验)


### 过于严格的FWE方法

之前介绍的FWE多重比较校正方法过于“严格”，导致一旦涉及多重比较问题，我们得到的样本很难得到显著的结果。

$$ \hat\alpha = 1 - (1 - \phi_n)^{1/n} $$

经过对数变换可得

$$ \log(1-\hat\alpha) = \frac{1}{n}\log(1-\phi_n) $$

由对数函数与线性函数，在$(0,1)$点的对应关系可知有如下近似关系

$$ \hat\alpha \approx \frac{1}{n}\phi_n $$

可知，我们可以近似的认为，当进行$n$次多重比较时，我们可以近似地认为校正后的$\hat\alpha$值为$\alpha$值的$\frac{1}{n}$。

它通常都让人绝望地小。
也就是说，FWE校验在数值上过于严格了。

### 寻找出路

既然我们必须坚信，FWE校验过于严格，我们就必须找到它**过于**严格的原因。

强辞夺理的我们当然不是缺借口的。
重新考虑多重比较的源头

$$ \phi_n = 1 - (1-\alpha)^n $$

在这里，我们其实已经假定了，所有参与比较的样本值犯第一类错误的概率都是$\alpha$。

这里我们就要提出一个问题：

> TMD凭什么？

事实上，对于前$m$个可能并不“平凡”的样本，我们犯第一类错误的综合概率，应该用下式计算

$$ \phi_n = 1 - \Pi_{i=1}^m (1-\alpha_i)  $$

其中，$m$个$\alpha$值分别代表这些样本的第一类错误概率值。
这些$\alpha$值是按从小到大的顺序进行排序的。

### FDR校验

根据以上分析，我们可以提出[False Detection Rate](https://www.publichealth.columbia.edu/research/population-health-methods/false-discovery-rate "False Detection Rate")校验方法。

该方法遵循该方程

$$ \phi_n = 1 - \Pi_{i=1}^m (1-\alpha_i)  $$

其中，$m$值是动态变化的，沿每个待比较样本的$\alpha$值，按从小到大的顺序依次进行计算。
直到$\phi_n$大于$0.05$为止。

可以看到，当有一个较小的$\alpha$值存在的情况下，可以容许较大的$\alpha$值通过校验，只要其综合第一错误概率水平不超过阈值即可。
